<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday Lamha Afrin ğŸ‚ğŸ’–</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #ffeef8 0%, #f3e5f5 25%, #fce4ec 50%, #f8bbd0 75%, #e1bee7 100%);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        .heart {
            position: fixed;
            font-size: 24px;
            animation: float 15s infinite linear;
            opacity: 0.6;
            pointer-events: none;
            z-index: 0;
        }

        @keyframes float {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 0.6; }
            90% { opacity: 0.6; }
            100% { transform: translateY(-100vh) rotate(720deg); opacity: 0; }
        }

        .sparkle {
            position: fixed;
            font-size: 20px;
            animation: sparkle 10s infinite linear;
            opacity: 0.4;
            pointer-events: none;
            z-index: 0;
        }

        @keyframes sparkle {
            0%, 100% { opacity: 0; transform: scale(0); }
            50% { opacity: 1; transform: scale(1); }
        }

        .music-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .music-toggle:hover {
            transform: scale(1.1);
        }

        .music-toggle.muted {
            background: #ffebee;
        }

        .music-status {
            position: fixed;
            top: 75px;
            right: 10px;
            background: rgba(255,255,255,0.9);
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            color: #880e4f;
            display: none;
            z-index: 1000;
        }

        .section {
            display: none;
            min-height: 100vh;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        .section.active {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .landing-container {
            text-align: center;
            animation: fadeInUp 1s ease;
        }

        h1 {
            font-size: 3em;
            color: #d81b60;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { text-shadow: 3px 3px 6px rgba(0,0,0,0.1), 0 0 20px #f8bbd0; }
            to { text-shadow: 3px 3px 6px rgba(0,0,0,0.1), 0 0 30px #f48fb1, 0 0 40px #f8bbd0; }
        }

        .subtext {
            font-size: 1.3em;
            color: #880e4f;
            margin-bottom: 40px;
            font-style: italic;
        }

        .start-btn {
            background: linear-gradient(45deg, #ff4081, #e040fb);
            color: white;
            border: none;
            padding: 20px 50px;
            font-size: 1.5em;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(255, 64, 129, 0.4);
            transition: all 0.3s ease;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .start-btn:hover {
            transform: translateY(-5px) scale(1.1);
        }

        .progress-container {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            padding: 15px 30px;
            border-radius: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            z-index: 100;
            display: none;
        }

        .progress-container.show {
            display: block;
        }

        .progress-bar {
            width: 200px;
            height: 10px;
            background: #fce4ec;
            border-radius: 5px;
            overflow: hidden;
            margin-top: 8px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff4081, #e040fb);
            width: 0%;
            transition: width 0.5s ease;
        }

        .game-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 30px;
            padding: 40px;
            max-width: 800px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
            position: relative;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .game-title {
            color: #ad1457;
            font-size: 2em;
            margin-bottom: 20px;
            text-align: center;
        }

        .game-hint {
            color: #880e4f;
            font-size: 1.1em;
            margin-bottom: 30px;
            text-align: center;
            font-style: italic;
        }

        .gift-box {
            width: 200px;
            height: 200px;
            background: linear-gradient(135deg, #ff4081, #e040fb);
            border-radius: 20px;
            margin: 0 auto 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 80px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .gift-box.shake {
            animation: shake 0.5s ease;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-20px) rotate(-5deg); }
            75% { transform: translateX(20px) rotate(5deg); }
        }

        .gift-box.open {
            animation: openGift 1s ease forwards;
        }

        @keyframes openGift {
            0% { transform: scale(1); }
            50% { transform: scale(1.2) rotate(10deg); }
            100% { transform: scale(1) rotate(0deg); background: #ffd700; }
        }

        .wheels-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        .wheel {
            width: 80px;
            height: 80px;
            border: 4px solid #ff4081;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            font-weight: bold;
            color: #ad1457;
            background: white;
            cursor: pointer;
            transition: all 0.2s ease;
            user-select: none;
        }

        .wheel:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 20px rgba(255, 64, 129, 0.3);
        }

        .unlock-btn {
            background: linear-gradient(45deg, #ff4081, #e040fb);
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.2em;
            border-radius: 30px;
            cursor: pointer;
            display: block;
            margin: 0 auto;
            transition: all 0.3s ease;
        }

        .unlock-btn:hover {
            transform: scale(1.05);
        }

        .feedback {
            text-align: center;
            margin-top: 20px;
            font-size: 1.2em;
            color: #880e4f;
            min-height: 30px;
        }

        .reward-message {
            background: linear-gradient(135deg, #fff3e0, #fce4ec);
            padding: 30px;
            border-radius: 20px;
            margin-top: 30px;
            text-align: center;
            font-size: 1.3em;
            color: #ad1457;
            display: none;
            animation: fadeInUp 0.5s ease;
            border: 3px solid #ff4081;
        }

        .next-btn {
            background: #4caf50;
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.2em;
            border-radius: 30px;
            cursor: pointer;
            margin-top: 20px;
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .cake-area {
            width: 300px;
            height: 300px;
            background: #fff8e1;
            border-radius: 20px;
            margin: 0 auto 20px;
            position: relative;
            border: 4px dashed #ffcc80;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .base-cake {
            font-size: 150px;
            position: absolute;
        }

        .decorations-palette {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .decoration-item {
            font-size: 40px;
            cursor: grab;
            padding: 10px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            transition: all 0.2s ease;
        }

        .decoration-item:hover {
            transform: scale(1.2);
        }

        .decoration-item.dragging {
            cursor: grabbing;
            position: fixed;
            z-index: 1000;
            pointer-events: none;
        }

        .placed-decoration {
            position: absolute;
            font-size: 40px;
            cursor: move;
            animation: popIn 0.3s ease;
        }

        @keyframes popIn {
            0% { transform: scale(0); }
            80% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .done-btn {
            background: #4caf50;
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.2em;
            border-radius: 30px;
            cursor: pointer;
            display: none;
            margin: 20px auto 0;
        }

        .done-btn.show {
            display: block;
        }

        .pin-board {
            width: 100%;
            height: 400px;
            background: linear-gradient(135deg, #e3f2fd, #f3e5f5);
            border-radius: 20px;
            position: relative;
            margin-bottom: 20px;
            overflow: hidden;
            border: 4px solid #ba68c8;
        }

        .target-zone {
            position: absolute;
            width: 100px;
            height: 100px;
            border: 4px dashed #e040fb;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
        }

        .draggable-balloon {
            font-size: 60px;
            cursor: grab;
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            transition: transform 0.2s ease;
            z-index: 10;
        }

        .draggable-balloon:active {
            cursor: grabbing;
        }

        .tries-display {
            text-align: center;
            font-size: 1.2em;
            color: #880e4f;
            margin-bottom: 10px;
        }

        .treasure-scene {
            width: 100%;
            height: 400px;
            background: linear-gradient(135deg, #fff3e0, #fce4ec, #f3e5f5);
            border-radius: 20px;
            position: relative;
            overflow: hidden;
            margin-bottom: 20px;
            border: 4px solid #ffab91;
        }

        .treasure-item {
            position: absolute;
            font-size: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .treasure-item:hover {
            transform: scale(1.3);
        }

        .treasure-item.found {
            animation: foundTreasure 0.5s ease forwards;
        }

        @keyframes foundTreasure {
            0% { transform: scale(1); }
            50% { transform: scale(1.5) rotate(360deg); }
            100% { transform: scale(0); opacity: 0; }
        }

        .treasure-counter {
            text-align: center;
            font-size: 1.3em;
            color: #ad1457;
            margin-bottom: 20px;
        }

        .final-cake-container {
            text-align: center;
            animation: fadeIn 1s ease;
        }

        .final-cake {
            font-size: 200px;
            position: relative;
            display: inline-block;
            margin: 30px 0;
        }

        .candle {
            position: absolute;
            font-size: 40px;
            cursor: pointer;
            transition: all 0.3s ease;
            animation: flicker 1s infinite alternate;
        }

        @keyframes flicker {
            0% { transform: scale(1); }
            100% { transform: scale(1.1); }
        }

        .candle.out {
            animation: none;
            filter: grayscale(100%);
            opacity: 0.5;
        }

        .candle.out::after {
            content: 'ğŸ’¨';
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 20px;
            animation: smoke 1s ease forwards;
        }

        @keyframes smoke {
            0% { opacity: 1; transform: translateX(-50%) translateY(0); }
            100% { opacity: 0; transform: translateX(-50%) translateY(-30px); }
        }

        .blow-instruction {
            font-size: 1.3em;
            color: #880e4f;
            margin-bottom: 20px;
            animation: pulse 2s infinite;
        }

        .letter-container {
            display: none;
            max-width: 800px;
            width: 100%;
            background: linear-gradient(135deg, #fff8e1, #fce4ec);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
            border: 3px solid #ff4081;
            position: relative;
            animation: fadeIn 1s ease;
            max-height: 80vh;
            overflow-y: auto;
        }

        .letter-container.show {
            display: block;
        }

        .letter-header {
            text-align: center;
            font-size: 2em;
            color: #ad1457;
            margin-bottom: 30px;
            font-family: 'Georgia', serif;
        }

        .letter-content {
            font-size: 1.1em;
            line-height: 2;
            color: #4a148c;
            font-family: 'Georgia', serif;
            white-space: pre-wrap;
            text-align: justify;
        }

        .typing-cursor {
            display: inline-block;
            width: 3px;
            height: 1.2em;
            background: #ad1457;
            animation: blink 1s infinite;
            margin-left: 5px;
            vertical-align: middle;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }

        .hearts-rain {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
            display: none;
        }

        .heart-drop {
            position: absolute;
            font-size: 24px;
            animation: drop 3s ease-in forwards;
        }

        @keyframes drop {
            0% { transform: translateY(-100px) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            top: -10px;
            animation: confetti-fall 3s ease-out forwards;
            z-index: 999;
        }

        @keyframes confetti-fall {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }

        @media (max-width: 600px) {
            h1 { font-size: 2em; }
            .game-container { padding: 20px; }
            .cake-area { width: 250px; height: 250px; }
            .base-cake { font-size: 100px; }
            .final-cake { font-size: 150px; }
        }
    </style>
</head>
<body>
    <!-- Sailor Song - Multiple fallback sources -->
    <audio id="bgMusic" loop preload="auto">
        <!-- Primary: Direct link to Sailor Song -->
        <source src="https://files.freemusicarchive.org/storage-freemusicarchive-org/music/no_curator/Galdson/Sailor_Song/Galdson_-_Sailor_Song.mp3" type="audio/mpeg">
        <!-- Fallback 1: Alternative source -->
        <source src="https://cdn.pixabay.com/download/audio/2022/10/14/audio_9939f792cb.mp3?filename=sailor-song-122111.mp3" type="audio/mpeg">
        <!-- Fallback 2: Another alternative -->
        <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
    </audio>

    <button class="music-toggle" id="musicBtn" onclick="toggleMusic()" title="Click to play/pause music">ğŸµ</button>
    <div class="music-status" id="musicStatus">Click to play Sailor Song!</div>

    <div id="floatingElements"></div>

    <div class="progress-container" id="progressBar">
        <div style="text-align: center; color: #ad1457; font-weight: bold;">Birthday Fun Progress: <span id="progressText">0/4</span></div>
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
    </div>

    <div class="section active" id="landing">
        <div class="landing-container">
            <h1>Happy Birthday Lamha Afrin ğŸ‚ğŸ’–</h1>
            <p class="subtext">Your surprise birthday adventure starts nowâ€¦</p>
            <button class="start-btn" onclick="startGames()">âœ¨ Start âœ¨</button>
        </div>
    </div>

    <div class="section" id="game1">
        <div class="game-container">
            <h2 class="game-title">ğŸ Game 1: Unlock the Birthday Gift</h2>
            <p class="game-hint">"Unlock the birthday surprise!"</p>
            
            <div class="gift-box" id="giftBox">ğŸ</div>
            
            <div class="wheels-container">
                <div class="wheel" onclick="changeWheel(0)">0</div>
                <div class="wheel" onclick="changeWheel(1)">0</div>
                <div class="wheel" onclick="changeWheel(2)">0</div>
            </div>
            
            <button class="unlock-btn" onclick="checkUnlock()">ğŸ”“ Unlock</button>
            <div class="feedback" id="game1Feedback"></div>
            
            <div class="reward-message" id="reward1">
                "You just unlocked my heart ğŸ’–â€¦ and it's all yours, Lamha ğŸ’«"
            </div>
            <button class="next-btn" id="next1" onclick="nextGame(2)">Continue to Game 2 â¡ï¸</button>
        </div>
    </div>

    <div class="section" id="game2">
        <div class="game-container">
            <h2 class="game-title">ğŸ‚ Game 2: Decorate the Birthday Cake</h2>
            <p class="game-hint">Drag decorations to make the cake beautiful!</p>
            
            <div class="cake-area" id="cakeArea">
                <div class="base-cake">ğŸ‚</div>
            </div>
            
            <div class="decorations-palette">
                <div class="decoration-item" draggable="true" data-emoji="ğŸ•¯ï¸">ğŸ•¯ï¸</div>
                <div class="decoration-item" draggable="true" data-emoji="ğŸ“">ğŸ“</div>
                <div class="decoration-item" draggable="true" data-emoji="ğŸ«">ğŸ«</div>
                <div class="decoration-item" draggable="true" data-emoji="ğŸ’">ğŸ’</div>
                <div class="decoration-item" draggable="true" data-emoji="ğŸ«">ğŸ«</div>
                <div class="decoration-item" draggable="true" data-emoji="ğŸ¬">ğŸ¬</div>
                <div class="decoration-item" draggable="true" data-emoji="âœ¨">âœ¨</div>
                <div class="decoration-item" draggable="true" data-emoji="ğŸŒŸ">ğŸŒŸ</div>
            </div>
            
            <button class="done-btn" id="doneBtn" onclick="finishDecorating()">Done Decorating âœ¨</button>
            
            <div class="reward-message" id="reward2">
                "Every decoration reminds me of you ğŸ«¶â€¦ you make everything more beautiful ğŸ’"
            </div>
            <button class="next-btn" id="next2" onclick="nextGame(3)">Continue to Game 3 â¡ï¸</button>
        </div>
    </div>

    <div class="section" id="game3">
        <div class="game-container">
            <h2 class="game-title">ğŸˆ Game 3: Pin the Balloon</h2>
            <p class="game-hint">Drag the balloon to the target zone!</p>
            
            <div class="tries-display">Tries remaining: <span id="triesLeft">3</span></div>
            
            <div class="pin-board" id="pinBoard">
                <div class="target-zone" id="targetZone" style="top: 50px; right: 50px;">ğŸ¯</div>
                <div class="draggable-balloon" id="balloon">ğŸˆ</div>
            </div>
            
            <div class="feedback" id="game3Feedback"></div>
            
            <div class="reward-message" id="reward3">
                "You pinned it perfectly, just like you've pinned yourself in my heart ğŸ’–âœ¨"
            </div>
            <button class="next-btn" id="next3" onclick="nextGame(4)">Continue to Game 4 â¡ï¸</button>
        </div>
    </div>

    <div class="section" id="game4">
        <div class="game-container">
            <h2 class="game-title">ğŸ•µï¸â€â™€ï¸ Game 4: Birthday Treasure Hunt</h2>
            <p class="game-hint">Find all 10 hidden love treasures!</p>
            
            <div class="treasure-counter">Found: <span id="treasureCount">0</span>/10</div>
            
            <div class="treasure-scene" id="treasureScene"></div>
            
            <div class="reward-message" id="reward4">
                "Every treasure I hide is a little piece of my heart for you ğŸ’â€¦ you found them all, Lamha ğŸ’–"
            </div>
            <button class="next-btn" id="next4" onclick="showFinalCake()">See Final Surprise ğŸ‚</button>
        </div>
    </div>

    <div class="section" id="finalCake">
        <div class="final-cake-container">
            <p style="font-size: 1.5em; color: #ad1457; margin-bottom: 20px; animation: fadeInUp 1s ease;">
                âœ¨ One last surprise for you, Lamhaâ€¦ âœ¨
            </p>
            
            <div class="blow-instruction">Click the candles to blow them out! ğŸ•¯ï¸</div>
            
            <div class="final-cake" id="finalCakeEmoji">
                ğŸ‚
                <div class="candle" style="top: -30px; left: 20%;" onclick="blowCandle(this)">ğŸ•¯ï¸</div>
                <div class="candle" style="top: -40px; left: 45%;" onclick="blowCandle(this)">ğŸ•¯ï¸</div>
                <div class="candle" style="top: -30px; left: 70%;" onclick="blowCandle(this)">ğŸ•¯ï¸</div>
            </div>
        </div>
    </div>

    <div class="section" id="loveLetter">
        <div class="letter-container" id="letterBox">
            <h2 class="letter-header">ğŸ’Œ To My Dearest Lamha ğŸ’Œ</h2>
            <div class="letter-content" id="letterText"></div>
            <span class="typing-cursor" id="cursor"></span>
        </div>
    </div>

    <div class="hearts-rain" id="heartsRain"></div>

    <script>
        let currentGame = 0;
        let gamesCompleted = 0;
        let musicPlaying = false;
        let wheels = [0, 0, 0];
        let decorationCount = 0;
        let triesLeft = 3;
        let treasuresFound = 0;
        let candlesBlown = 0;
        let audioLoaded = false;

        function createFloatingElements() {
            const container = document.getElementById('floatingElements');
            const hearts = ['ğŸ’–', 'ğŸ’•', 'ğŸ’—', 'ğŸ’“', 'ğŸ’'];
            const sparkles = ['âœ¨', 'ğŸŒŸ', 'ğŸ’«'];
            
            for (let i = 0; i < 15; i++) {
                const heart = document.createElement('div');
                heart.className = 'heart';
                heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
                heart.style.left = Math.random() * 100 + '%';
                heart.style.animationDelay = Math.random() * 15 + 's';
                heart.style.animationDuration = (15 + Math.random() * 10) + 's';
                container.appendChild(heart);
            }
            
            for (let i = 0; i < 10; i++) {
                const sparkle = document.createElement('div');
                sparkle.className = 'sparkle';
                sparkle.textContent = sparkles[Math.floor(Math.random() * sparkles.length)];
                sparkle.style.left = Math.random() * 100 + '%';
                sparkle.style.top = Math.random() * 100 + '%';
                sparkle.style.animationDelay = Math.random() * 10 + 's';
                container.appendChild(sparkle);
            }
        }

        createFloatingElements();

        // FIXED: Better music handling with error detection
        function initAudio() {
            const audio = document.getElementById('bgMusic');
            
            audio.addEventListener('canplaythrough', () => {
                audioLoaded = true;
                console.log('Sailor Song loaded successfully!');
            });
            
            audio.addEventListener('error', (e) => {
                console.log('Audio error:', e);
                document.getElementById('musicStatus').textContent = 'Music unavailable - click for local file';
                document.getElementById('musicStatus').style.display = 'block';
            });
            
            // Try to load
            audio.load();
        }

        initAudio();

        function toggleMusic() {
            const audio = document.getElementById('bgMusic');
            const btn = document.getElementById('musicBtn');
            const status = document.getElementById('musicStatus');
            
            if (musicPlaying) {
                audio.pause();
                btn.textContent = 'ğŸ”‡';
                btn.classList.add('muted');
                status.textContent = 'Music paused';
                status.style.display = 'block';
                musicPlaying = false;
            } else {
                // Set volume and try to play
                audio.volume = 0.4;
                
                const playPromise = audio.play();
                
                if (playPromise !== undefined) {
                    playPromise.then(() => {
                        // Playing successfully
                        btn.textContent = 'ğŸµ';
                        btn.classList.remove('muted');
                        status.textContent = 'â™ª Sailor Song playing...';
                        status.style.display = 'block';
                        musicPlaying = true;
                        
                        setTimeout(() => {
                            status.style.display = 'none';
                        }, 3000);
                    }).catch(error => {
                        // Autoplay blocked or other error
                        console.log('Play error:', error);
                        btn.textContent = 'ğŸ”‡';
                        status.textContent = 'Click Start first, then try music!';
                        status.style.display = 'block';
                        
                        // If audio not loaded, try reloading
                        if (!audioLoaded) {
                            audio.load();
                        }
                    });
                }
            }
        }

        function showSection(id) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        function startGames() {
            document.getElementById('progressBar').classList.add('show');
            updateProgress();
            showSection('game1');
            currentGame = 1;
            
            // Try to autoplay music after user interaction (Start button)
            const audio = document.getElementById('bgMusic');
            audio.volume = 0.4;
            audio.play().then(() => {
                musicPlaying = true;
                document.getElementById('musicBtn').textContent = 'ğŸµ';
                document.getElementById('musicBtn').classList.remove('muted');
                console.log('Music autoplayed after Start click');
            }).catch(() => {
                // Show hint to manually play
                document.getElementById('musicStatus').style.display = 'block';
                setTimeout(() => {
                    document.getElementById('musicStatus').style.display = 'none';
                }, 5000);
            });
        }

        function updateProgress() {
            document.getElementById('progressText').textContent = gamesCompleted + '/4';
            document.getElementById('progressFill').style.width = (gamesCompleted * 25) + '%';
        }

        function completeGame(gameNum) {
            if (gameNum > gamesCompleted) {
                gamesCompleted = gameNum;
                updateProgress();
            }
        }

        function nextGame(num) {
            showSection('game' + num);
            currentGame = num;
            
            if (num === 4) {
                initTreasureHunt();
            }
        }

        function changeWheel(index) {
            wheels[index] = (wheels[index] + 1) % 10;
            document.querySelectorAll('.wheel')[index].textContent = wheels[index];
        }

        function checkUnlock() {
            const correct = [1, 5, 9];
            const giftBox = document.getElementById('giftBox');
            const feedback = document.getElementById('game1Feedback');
            
            if (wheels[0] === 1 && wheels[1] === 5 && wheels[2] === 9) {
                giftBox.classList.add('open');
                giftBox.textContent = 'ğŸ’–';
                feedback.textContent = 'ğŸ‰ Correct! The gift is unlocked!';
                feedback.style.color = '#4caf50';
                createConfetti();
                
                setTimeout(() => {
                    document.getElementById('reward1').style.display = 'block';
                    document.getElementById('next1').style.display = 'inline-block';
                    completeGame(1);
                }, 1000);
            } else {
                giftBox.classList.add('shake');
                feedback.textContent = 'Almost! Try again ğŸ˜ (Hint: 15/9!)';
                feedback.style.color = '#d81b60';
                
                setTimeout(() => {
                    giftBox.classList.remove('shake');
                }, 500);
            }
        }

        function initDragAndDrop() {
            const items = document.querySelectorAll('.decoration-item');
            const cakeArea = document.getElementById('cakeArea');
            
            items.forEach(item => {
                item.addEventListener('dragstart', (e) => {
                    e.dataTransfer.setData('emoji', item.dataset.emoji);
                });
                
                item.addEventListener('touchstart', handleTouchStart, {passive: false});
                item.addEventListener('touchmove', handleTouchMove, {passive: false});
                item.addEventListener('touchend', handleTouchEnd);
            });
            
            cakeArea.addEventListener('dragover', (e) => e.preventDefault());
            cakeArea.addEventListener('drop', (e) => {
                e.preventDefault();
                const emoji = e.dataTransfer.getData('emoji');
                placeDecoration(e.clientX, e.clientY, emoji);
            });
        }

        let draggedItem = null;
        let touchOffset = {x: 0, y: 0};

        function handleTouchStart(e) {
            e.preventDefault();
            draggedItem = e.target;
            const touch = e.touches[0];
            const rect = draggedItem.getBoundingClientRect();
            touchOffset.x = touch.clientX - rect.left;
            touchOffset.y = touch.clientY - rect.top;
            draggedItem.classList.add('dragging');
        }

        function handleTouchMove(e) {
            e.preventDefault();
            if (!draggedItem) return;
            const touch = e.touches[0];
            draggedItem.style.left = (touch.clientX - touchOffset.x) + 'px';
            draggedItem.style.top = (touch.clientY - touchOffset.y) + 'px';
        }

        function handleTouchEnd(e) {
            if (!draggedItem) return;
            const touch = e.changedTouches[0];
            const cakeArea = document.getElementById('cakeArea');
            const rect = cakeArea.getBoundingClientRect();
            
            if (touch.clientX >= rect.left && touch.clientX <= rect.right &&
                touch.clientY >= rect.top && touch.clientY <= rect.bottom) {
                placeDecoration(touch.clientX, touch.clientY, draggedItem.dataset.emoji);
            }
            
            draggedItem.classList.remove('dragging');
            draggedItem.style.left = '';
            draggedItem.style.top = '';
            draggedItem = null;
        }

        function placeDecoration(x, y, emoji) {
            const cakeArea = document.getElementById('cakeArea');
            const rect = cakeArea.getBoundingClientRect();
            
            const deco = document.createElement('div');
            deco.className = 'placed-decoration';
            deco.textContent = emoji;
            deco.style.left = (x - rect.left - 20) + 'px';
            deco.style.top = (y - rect.top - 20) + 'px';
            
            cakeArea.appendChild(deco);
            decorationCount++;
            
            if (decorationCount >= 3) {
                document.getElementById('doneBtn').classList.add('show');
            }
            
            createSparkle(x, y);
        }

        function finishDecorating() {
            document.getElementById('reward2').style.display = 'block';
            document.getElementById('next2').style.display = 'inline-block';
            document.getElementById('doneBtn').style.display = 'none';
            completeGame(2);
            createConfetti();
        }

        function initPinBalloon() {
            const balloon = document.getElementById('balloon');
            const board = document.getElementById('pinBoard');
            let isDragging = false;
            
            balloon.addEventListener('mousedown', startDrag);
            balloon.addEventListener('touchstart', startDrag, {passive: false});
            
            function startDrag(e) {
                e.preventDefault();
                isDragging = true;
                balloon.style.cursor = 'grabbing';
            }
            
            document.addEventListener('mousemove', drag);
            document.addEventListener('touchmove', drag, {passive: false});
            document.addEventListener('mouseup', endDrag);
            document.addEventListener('touchend', endDrag);
            
            function drag(e) {
                if (!isDragging) return;
                e.preventDefault();
                
                const clientX = e.touches ? e.touches[0].clientX : e.clientX;
                const clientY = e.touches ? e.touches[0].clientY : e.clientY;
                
                const rect = board.getBoundingClientRect();
                const x = clientX - rect.left - 30;
                const y = clientY - rect.top - 30;
                
                balloon.style.left = x + 'px';
                balloon.style.top = y + 'px';
                balloon.style.bottom = 'auto';
                balloon.style.transform = 'none';
            }
            
            function endDrag() {
                if (!isDragging) return;
                isDragging = false;
                balloon.style.cursor = 'grab';
                
                checkBalloonPlacement();
            }
        }

        function checkBalloonPlacement() {
            const balloon = document.getElementById('balloon');
            const target = document.getElementById('targetZone');
            const feedback = document.getElementById('game3Feedback');
            
            const ballRect = balloon.getBoundingClientRect();
            const targetRect = target.getBoundingClientRect();
            
            const overlap = !(ballRect.right < targetRect.left || 
                            ballRect.left > targetRect.right || 
                            ballRect.bottom < targetRect.top || 
                            ballRect.top > targetRect.bottom);
            
            if (overlap) {
                feedback.textContent = 'ğŸ‰ Perfect! You pinned it!';
                feedback.style.color = '#4caf50';
                document.getElementById('reward3').style.display = 'block';
                document.getElementById('next3').style.display = 'inline-block';
                completeGame(3);
                createConfetti();
                createFireworks();
            } else {
                triesLeft--;
                document.getElementById('triesLeft').textContent = triesLeft;
                
                if (triesLeft <= 0) {
                    feedback.textContent = 'Hint: Try the top right corner! ğŸ’';
                    target.style.border = '4px solid #ff0000';
                } else {
                    feedback.textContent = 'Almost! Try again âœ¨ (' + triesLeft + ' tries left)';
                    feedback.style.color = '#ff9800';
                }
            }
        }

        function initTreasureHunt() {
            const scene = document.getElementById('treasureScene');
            scene.innerHTML = '';
            treasuresFound = 0;
            document.getElementById('treasureCount').textContent = '0';
            
            const treasures = ['ğŸ’–', 'ğŸ’•', 'ğŸ’—', 'ğŸ’“', 'ğŸ’', 'âœ¨', 'ğŸŒŸ', 'ğŸ’«', 'ğŸ', 'ğŸ€'];
            const distractions = ['ğŸ‚', 'ğŸ§', 'ğŸˆ', 'ğŸ‰', 'ğŸŠ', 'ğŸ', 'ğŸ€', 'ğŸ•¯ï¸', 'ğŸ°', 'ğŸ®'];
            
            treasures.forEach((t, i) => {
                const el = document.createElement('div');
                el.className = 'treasure-item';
                el.textContent = t;
                el.style.left = (10 + Math.random() * 80) + '%';
                el.style.top = (10 + Math.random() * 80) + '%';
                el.onclick = () => foundTreasure(el);
                scene.appendChild(el);
            });
            
            for (let i = 0; i < 8; i++) {
                const el = document.createElement('div');
                el.className = 'treasure-item';
                el.textContent = distractions[i];
                el.style.left = (10 + Math.random() * 80) + '%';
                el.style.top = (10 + Math.random() * 80) + '%';
                el.style.opacity = '0.7';
                scene.appendChild(el);
            }
        }

        function foundTreasure(el) {
            if (el.classList.contains('found')) return;
            
            el.classList.add('found');
            treasuresFound++;
            document.getElementById('treasureCount').textContent = treasuresFound;
            
            createSparkle(
                el.getBoundingClientRect().left + 15,
                el.getBoundingClientRect().top + 15
            );
            
            if (treasuresFound >= 10) {
                setTimeout(() => {
                    document.getElementById('reward4').style.display = 'block';
                    document.getElementById('next4').style.display = 'inline-block';
                    completeGame(4);
                    createConfetti();
                }, 500);
            }
        }

        function showFinalCake() {
            showSection('finalCake');
            document.getElementById('progressBar').style.display = 'none';
        }

        function blowCandle(candle) {
            if (candle.classList.contains('out')) return;
            
            candle.classList.add('out');
            candlesBlown++;
            
            createSmoke(candle);
            
            if (candlesBlown >= 3) {
                setTimeout(() => {
                    showLoveLetter();
                }, 1500);
            }
        }

        function createSmoke(candle) {
            const rect = candle.getBoundingClientRect();
            for (let i = 0; i < 5; i++) {
                setTimeout(() => {
                    const smoke = document.createElement('div');
                    smoke.textContent = 'ğŸ’¨';
                    smoke.style.position = 'fixed';
                    smoke.style.left = rect.left + 'px';
                    smoke.style.top = rect.top + 'px';
                    smoke.style.fontSize = '20px';
                    smoke.style.pointerEvents = 'none';
                    smoke.style.animation = 'smoke 1s ease forwards';
                    smoke.style.zIndex = '1000';
                    document.body.appendChild(smoke);
                    setTimeout(() => smoke.remove(), 1000);
                }, i * 100);
            }
        }

        function showLoveLetter() {
            showSection('loveLetter');
            document.getElementById('letterBox').classList.add('show');
            startHeartsRain();
            
            const letter = `Ami really jani na kotha theke shuru korbo L. Ami tbh insta use o kortam na. And amr love er proti interest o chilona. Really! Ami bissash kortam na aisob e....But then you came into my life!!! God was really on my side when He wrote you into my story. Right at a time, I didn't even know I needed you. Amr akhono mone ase gc teh porichoy hoisilo ğŸ‘½. Then nadishar shate olpo kotha hoito amr dm e ar tmi amk akdin message disila diye bolsila je-"nadisha bolse tmi naki onk innocent dekte. Koi dekhi toh tmk." Aita diye e amder dm e kotha shuru hoi!! Tmi amk nadishar shate ship korta ğŸ¤¡ğŸ˜­. Nadishar copy teo naki likhe ashta je N+Z ğŸ¸ğŸ’”. Erpor aste aste baad diye diso or kotha ğŸ—¿. Then oije kutta Tamim ta tmk onk jalaito dm e msg kore ar tmi amk bolta je "jao jao tamim er shate kotha bolo. O amk jalaitese msg diye diye. Oke na koro amk message dite." Then ami ar tmi onk kotha boltam! Like onk beshi ğŸ‘½. Tmiyo active thakta onk tokhon ar amiyo ğŸ¥¸. Amder onk kichu milto ar tmr shate kotha bole onk moja paitam! Lagto je jakh keo toh atleast amk bujhe.... Amr moton kaoke paisi!!!ğŸ‘¾ğŸ’–. Then aste aste tmk pochondo o hoye jai ğŸ˜ºğŸ©·. Ami onk vabsilam bolbo ki bolbona but bole disilam ğŸ˜­ğŸ¤¡. Bhai kemne je atoh sahosh paisilam bolar jnno!!â˜ ï¸. Tmk onk force kortam je matching pfp diteh then story teh mention diteh.... But oisob moteo thik kori nai ğŸ˜âœ‹. Love show off korar jinish na oita ami pore jeye realize korsi ğŸ¤§ğŸ¤§. Ager kotha guli baad di. Oisob pura bolte gele tmr amr msg ta porte 3 din laiga jabe ğŸ‘½. Birthday ar enjoy kora lagbena!!

Tohh.. akhoner kotha teh ashi!!ğŸ. Honestly ami nijeo jani na kivabe ami tmk peye gesi!ğŸŒŸ. Ami onk appreciate kori je tmi amr life e ascho!!! Amr life black and white screen er moton chilo ar tmi eshe oita ke colourful kore diso!!! ğŸƒ. Ami thik kore nijer moner kotha prokash korte partesina msg gula teh bhai ğŸ˜¿. But ami sotti tmk peye onk beshi lucky feel kori! Tmi always amr pashe thako sob kichu teh! Then amk comfort o feel korao! Tmk chara je amr ki hoito bhai!ğŸ™†ğŸ¤¦. Last 1 month e amra aro onk beshiii closeee hoye gesi really!! Onkk beshi!

Bangla teh bolte partesina, English ei boli ğŸ™. You are the one who completes me! Tmk chara ami kono future vabtei parina tbh!! Jodi tmi amr kopale likhao na thako, ami Allah er kache attoh dua korbo je Allah tmk amr banay dibe In'sha'Allah ğŸ˜º. Tmk ami kemne bujhay je ami tmk kotota love kori ğŸ˜­. Tmi amr kache kotota special!!! Tmr shate katano prottek ta moment e special! Shuru theke sesh porjonto sob mone ase amr! You are in my heart â¤ï¸â€ğŸ©¹. You shall be in there FOREVER. My greatest wish is that you are HAPPY when you think of ME, I am when I think of YOU. You are a princess!ğŸ’“. But not every princess wears a crown. Some rule hearts, the way you rule my heart âœ¨. Nothing is coincidence. Every soul we met is written in our destiny. To teach us, to heal us or to love us ğŸ¤§. Tmi amr taqdeer e likha chila ğŸ’˜. Remember!! I get tired of everything sometimes, But never of you. Even when I world exhausts me, you're all I need ğŸ’¯ğŸª¼. Ami...aikhane bole tmk bujhaiteo parbona ar sesh o korte parbona bole je tmi amr kache kotota important ğŸ˜. Always boli and abar o boltesi je- YOU make me feel like home lamha ğŸ«¶.

15 hoye gela!! Ami always jateh tmr birthday teh tmk wish korte pari ar amra jateh kokhono alada na hoye jai aita e dua korbo!!! Tmi jateh always happy thako and always jateh mone rakho je ami tmr pashe always asi!! Enjoy koro birthday! Tmk kono gift diteh partesina ğŸ˜­. I really wanted to gift you something ğŸ™. But sadly amr ar tmr distance ta onk beshi ğŸ« . Maybe ai distance tar karone e amder bond atoh strong ğŸª¼ğŸ˜º. Bhai onk boro hoye gese ğŸ¥¸. Thak ar barabona! Always stay strong and stay healthy!!! And amr shate jateh sob kichu share koro always âœŒï¸. I really like to listen to you ğŸƒ.

Happy Birthday My Love! ğŸ‚ğŸ’–âœ¨

- Yours Forever ğŸ’•`;
            
            typeWriter(letter, 0);
        }

        function typeWriter(text, index) {
            if (index < text.length) {
                document.getElementById('letterText').textContent += text.charAt(index);
                setTimeout(() => typeWriter(text, index + 1), 30);
                
                const letterBox = document.getElementById('letterBox');
                letterBox.scrollTop = letterBox.scrollHeight;
            } else {
                document.getElementById('cursor').style.display = 'none';
            }
        }

        function createConfetti() {
            const colors = ['#ff4081', '#e040fb', '#ffd700', '#ff6b6b', '#4ecdc4'];
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = Math.random() * 2 + 's';
                document.body.appendChild(confetti);
                setTimeout(() => confetti.remove(), 3000);
            }
        }

        function createSparkle(x, y) {
            const sparkle = document.createElement('div');
            sparkle.textContent = 'âœ¨';
            sparkle.style.position = 'fixed';
            sparkle.style.left = x + 'px';
            sparkle.style.top = y + 'px';
            sparkle.style.fontSize = '30px';
            sparkle.style.pointerEvents = 'none';
            sparkle.style.zIndex = '1000';
            sparkle.style.animation = 'popIn 0.5s ease forwards';
            document.body.appendChild(sparkle);
            setTimeout(() => sparkle.remove(), 500);
        }

        function createFireworks() {
            for (let i = 0; i < 5; i++) {
                setTimeout(() => {
                    const x = 20 + Math.random() * 60;
                    const y = 20 + Math.random() * 40;
                    for (let j = 0; j < 20; j++) {
                        const particle = document.createElement('div');
                        particle.style.position = 'fixed';
                        particle.style.left = x + '%';
                        particle.style.top = y + '%';
                        particle.style.width = '8px';
                        particle.style.height = '8px';
                        particle.style.borderRadius = '50%';
                        particle.style.background = `hsl(${Math.random() * 360}, 100%, 50%)`;
                        particle.style.pointerEvents = 'none';
                        particle.style.zIndex = '999';
                        
                        const angle = (Math.PI * 2 * j) / 20;
                        const velocity = 100 + Math.random() * 100;
                        const tx = Math.cos(angle) * velocity;
                        const ty = Math.sin(angle) * velocity;
                        
                        particle.style.animation = 'none';
                        particle.style.transition = 'all 1s ease-out';
                        document.body.appendChild(particle);
                        
                        setTimeout(() => {
                            particle.style.transform = `translate(${tx}px, ${ty}px)`;
                            particle.style.opacity = '0';
                        }, 10);
                        
                        setTimeout(() => particle.remove(), 1000);
                    }
                }, i * 300);
            }
        }

        function startHeartsRain() {
            const container = document.getElementById('heartsRain');
            container.style.display = 'block';
            
            const hearts = ['ğŸ’–', 'ğŸ’•', 'ğŸ’—', 'ğŸ’“', 'ğŸ’', 'ğŸ’˜', 'ğŸ’'];
            
            setInterval(() => {
                const heart = document.createElement('div');
                heart.className = 'heart-drop';
                heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
                heart.style.left = Math.random() * 100 + '%';
                heart.style.fontSize = (20 + Math.random() * 20) + 'px';
                container.appendChild(heart);
                
                setTimeout(() => heart.remove(), 3000);
            }, 200);
        }

        initDragAndDrop();
        initPinBalloon();
    </script>
</body>
</html>
            
